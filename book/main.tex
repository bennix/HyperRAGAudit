\documentclass[12pt,a4paper,openany]{book}

% ============================================================
% Encoding & Fonts
% ============================================================
\usepackage[UTF8]{ctex}
\usepackage{fontspec}

% ============================================================
% Page Layout
% ============================================================
\usepackage[
  top=2.5cm, bottom=2.5cm,
  left=2.5cm, right=2.5cm,
  headheight=14pt
]{geometry}

% ============================================================
% Packages
% ============================================================
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{tcolorbox}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{makeidx}

\usetikzlibrary{arrows.meta, positioning, shapes.geometric, fit}

% ============================================================
% Colors
% ============================================================
\definecolor{codeblue}{RGB}{0,102,204}
\definecolor{codegray}{RGB}{128,128,128}
\definecolor{codegreen}{RGB}{0,128,0}
\definecolor{codered}{RGB}{204,0,0}
\definecolor{codebg}{RGB}{248,248,248}
\definecolor{chaptercolor}{RGB}{0,82,155}
\definecolor{tipbg}{RGB}{232,245,233}
\definecolor{warnbg}{RGB}{255,243,224}
\definecolor{notebg}{RGB}{227,242,253}

% ============================================================
% Code Listings
% ============================================================
\lstset{
  language=Python,
  basicstyle=\small\ttfamily,
  keywordstyle=\color{codeblue}\bfseries,
  stringstyle=\color{codered},
  commentstyle=\color{codegreen}\itshape,
  numberstyle=\tiny\color{codegray},
  backgroundcolor=\color{codebg},
  numbers=left,
  numbersep=8pt,
  tabsize=4,
  showstringspaces=false,
  breaklines=true,
  frame=single,
  rulecolor=\color{codegray!30},
  xleftmargin=15pt,
  framexleftmargin=15pt,
  aboveskip=10pt,
  belowskip=10pt,
  escapeinside={(*@}{@*)},
  literate={*}{{\char42}}1,
}

\lstdefinelanguage{yaml}{
  keywords={true,false,null,y,n},
  keywordstyle=\color{codeblue}\bfseries,
  sensitive=false,
  comment=[l]{\#},
  commentstyle=\color{codegreen}\itshape,
  stringstyle=\color{codered},
  morestring=[b]',
  morestring=[b]",
}

\lstdefinelanguage{json}{
  string=[s]{"}{"},
  stringstyle=\color{codered},
  comment=[l]{//},
  commentstyle=\color{codegreen}\itshape,
  literate=
    *{0}{{{\color{codeblue}0}}}{1}
    {1}{{{\color{codeblue}1}}}{1}
    {2}{{{\color{codeblue}2}}}{1}
    {3}{{{\color{codeblue}3}}}{1}
    {4}{{{\color{codeblue}4}}}{1}
    {5}{{{\color{codeblue}5}}}{1}
    {6}{{{\color{codeblue}6}}}{1}
    {7}{{{\color{codeblue}7}}}{1}
    {8}{{{\color{codeblue}8}}}{1}
    {9}{{{\color{codeblue}9}}}{1},
}

% ============================================================
% Custom Boxes
% ============================================================
\newtcolorbox{tipbox}[1][]{
  colback=tipbg, colframe=green!60!black,
  fonttitle=\bfseries, title={#1},
  sharp corners, boxrule=0.5pt,
}

\newtcolorbox{warnbox}[1][]{
  colback=warnbg, colframe=orange!80!black,
  fonttitle=\bfseries, title={#1},
  sharp corners, boxrule=0.5pt,
}

\newtcolorbox{notebox}[1][]{
  colback=notebg, colframe=blue!60!black,
  fonttitle=\bfseries, title={#1},
  sharp corners, boxrule=0.5pt,
}

% ============================================================
% Headers
% ============================================================
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE]{\leftmark}
\fancyhead[RO]{\rightmark}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}

% ============================================================
% Hyperref
% ============================================================
\hypersetup{
  colorlinks=true,
  linkcolor=chaptercolor,
  citecolor=codegreen,
  urlcolor=codeblue,
  bookmarks=true,
  pdfauthor={HyperRAG Team},
  pdftitle={从零构建企业级 RAG 审计系统},
}

% ============================================================
% Index
% ============================================================
\makeindex

% ============================================================
% Title
% ============================================================
\title{
  \vspace{2cm}
  {\Huge\bfseries 从零构建企业级 RAG 审计系统} \\[0.8cm]
  {\Large\color{chaptercolor} 基于 HyperRAG 的完整实战剖析} \\[1.5cm]
  {\large Vision LLM $\cdot$ 知识图谱 $\cdot$ Agent $\cdot$ 溯源高亮}
  \vspace{2cm}
}
\author{
  {\Large HyperRAG Team} \\[0.3cm]
  {\normalsize LLM API: \href{https://zenmux.ai/invite/GBQMC5}{zenmux.ai}}
}
\date{\today}

% ============================================================
% Document
% ============================================================
\begin{document}

\frontmatter
\maketitle
\tableofcontents

\mainmatter
\include{chapters/ch01-introduction}
\include{chapters/ch02-architecture}
\include{chapters/ch03-document-processing}
\include{chapters/ch04-vision-ocr}
\include{chapters/ch05-vector-database}
\include{chapters/ch06-knowledge-graph}
\include{chapters/ch07-agent}
\include{chapters/ch08-highlighting}
\include{chapters/ch09-web-ui}
\include{chapters/ch10-deployment}

\backmatter
\printindex

\end{document}
